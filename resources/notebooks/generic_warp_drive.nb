(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    102672,       2753]
NotebookOptionsPosition[     95086,       2609]
NotebookOutlinePosition[     95726,       2631]
CellTagsIndexPosition[     95683,       2628]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Generic Natario warp drive and deflector shield", "Title",
 CellChangeTimes->{{3.954411474616445*^9, 3.954411492674542*^9}, {
  3.956964554761085*^9, 
  3.95696457194346*^9}},ExpressionUUID->"bed048af-a5ca-4f0b-b6f6-\
0a823403fb74"],

Cell[CellGroupData[{

Cell["Geometric quantities", "Section",
 CellChangeTimes->{{3.9544114960210447`*^9, 3.9544114969795322`*^9}, {
  3.9558104027015533`*^9, 
  3.9558104061706133`*^9}},ExpressionUUID->"ad33c86b-e3a4-4257-8179-\
3dd8917aa76b"],

Cell[CellGroupData[{

Cell["Base quantities", "Subsection",
 CellChangeTimes->{{3.9605477819572067`*^9, 
  3.96054778409966*^9}},ExpressionUUID->"4967b404-806c-4dcc-84a4-\
e57d86f36387"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "coordsU", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coordsU", "=", 
    RowBox[{"{", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "vU", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vU", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vx", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
      RowBox[{"vy", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
      RowBox[{"vz", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "gUU", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gUU", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Alpha]", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "2"}], ")"}]}], 
      RowBox[{"{", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", 
           RowBox[{"vU", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"vU", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"vU", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", "\n", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"vU", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Alpha]", "[", 
             RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "^", "2"}], 
           "-", 
           RowBox[{
            RowBox[{"vU", "[", 
             RowBox[{"[", "1", "]"}], "]"}], 
            RowBox[{"vU", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"vU", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], 
           RowBox[{"vU", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"vU", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], 
           RowBox[{"vU", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", "\n", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"vU", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"vU", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], 
           RowBox[{"vU", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Alpha]", "[", 
             RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "^", "2"}], 
           "-", 
           RowBox[{
            RowBox[{"vU", "[", 
             RowBox[{"[", "2", "]"}], "]"}], 
            RowBox[{"vU", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"vU", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], 
           RowBox[{"vU", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", "\n", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"vU", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"vU", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], 
           RowBox[{"vU", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"vU", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], 
           RowBox[{"vU", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Alpha]", "[", 
             RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "^", "2"}], 
           "-", 
           RowBox[{
            RowBox[{"vU", "[", 
             RowBox[{"[", "3", "]"}], "]"}], 
            RowBox[{"vU", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}]}], "}"}]}], "\n", "}"}]}], "//",
      "FullSimplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "gLL", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gLL", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Inverse", "[", "gUU", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9541686173129587`*^9, 3.9541687707198277`*^9}, {
   3.95417232528426*^9, 3.954172327194663*^9}, {3.95417238764052*^9, 
   3.954172606185693*^9}, {3.954172659992856*^9, 3.954172707082992*^9}, {
   3.954173020759755*^9, 3.954173078831015*^9}, {3.954174294381667*^9, 
   3.954174317361146*^9}, {3.954174351461337*^9, 3.954174359616845*^9}, {
   3.95436137058225*^9, 3.9543613905557623`*^9}, {3.954361616286333*^9, 
   3.954361654783115*^9}, {3.9544115058348618`*^9, 3.954411518644565*^9}, {
   3.954411584390973*^9, 3.9544116804735737`*^9}, {3.955810409758565*^9, 
   3.955810445757955*^9}, {3.9558105108282948`*^9, 3.955810734961289*^9}, {
   3.95581078561799*^9, 3.955810959667181*^9}, {3.9558109915441504`*^9, 
   3.955811051578422*^9}, {3.955811120046208*^9, 3.955811178222454*^9}, {
   3.9558112214865713`*^9, 3.955811261497965*^9}, {3.955811337620902*^9, 
   3.95581134589882*^9}, {3.9558113856313143`*^9, 3.955811387965905*^9}, 
   3.955811426259285*^9, {3.955811461398423*^9, 3.9558114694046497`*^9}, {
   3.9558115449800043`*^9, 3.95581160957784*^9}, {3.955812213763946*^9, 
   3.955812508422171*^9}, {3.955812551272944*^9, 3.9558125555146503`*^9}, {
   3.955812588388248*^9, 3.9558126364451103`*^9}, {3.955812711319002*^9, 
   3.955812845309157*^9}, {3.955813452687645*^9, 3.9558134641770983`*^9}, {
   3.955813767329068*^9, 3.9558137894302807`*^9}, {3.955813826872389*^9, 
   3.955813907886932*^9}, {3.955985658522842*^9, 3.955985697124757*^9}, {
   3.955985739285636*^9, 3.955985739494197*^9}, 3.959858860971013*^9, {
   3.959976303344379*^9, 3.95997635304172*^9}, {3.959976408857153*^9, 
   3.9599764348128223`*^9}, {3.959976596730178*^9, 3.959976625648563*^9}, {
   3.959978262049123*^9, 3.959978265724103*^9}, 3.95997848076761*^9, {
   3.960298573579851*^9, 3.96029857808853*^9}, {3.96030259630828*^9, 
   3.960302596950251*^9}, {3.9605472806040363`*^9, 3.960547349517398*^9}, {
   3.960548867660366*^9, 3.960548874462163*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"e0dded18-309d-437b-b537-3139e3f12d23"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ADM quantities", "Subsection",
 CellChangeTimes->{{3.9605477910066833`*^9, 
  3.960547793386784*^9}},ExpressionUUID->"2caf8caf-a570-471e-92ff-\
0982f27f3efc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "scoordsU", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"scoordsU", "=", 
    RowBox[{"coordsU", "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;", "4"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"\[Gamma]LL", ",", "\[Gamma]UU"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]LL", "=", 
   RowBox[{"gLL", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", "4"}], ",", 
      RowBox[{"2", ";;", "4"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]UU", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Inverse", "[", "\[Gamma]LL", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "lapse", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lapse", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "/", 
        RowBox[{"gUU", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"\[Alpha]", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ">=", "0"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"\[Beta]U", ",", "\[Beta]L"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]U", "=", 
   RowBox[{
    RowBox[{"gUU", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", 
       RowBox[{"2", ";;", "4"}]}], "]"}], "]"}], 
    RowBox[{
     RowBox[{"\[Alpha]", "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "^", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]L", "=", 
    RowBox[{"gLL", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", 
       RowBox[{"2", ";;", "4"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "KLL", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KLL", "=", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", "lapse"}], ")"}]}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Beta]L", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", 
            RowBox[{"scoordsU", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "+", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"\[Beta]L", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"scoordsU", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], "//", "FullSimplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"nU", ",", "nL"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nU", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", "/", "lapse"}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "\[Beta]U"}], "/", "lapse"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nL", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gLL", "[", 
          RowBox[{"[", 
           RowBox[{"a", ",", "b"}], "]"}], "]"}], 
         RowBox[{"nU", "[", 
          RowBox[{"[", "b", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.960547362253537*^9, 3.960547370719689*^9}, {
   3.960547408152211*^9, 3.960547548856473*^9}, {3.9605477136195908`*^9, 
   3.960547768783516*^9}, {3.960547809548645*^9, 3.960547829109232*^9}, 
   3.9605478899615393`*^9, {3.960547942497789*^9, 3.960547942911655*^9}, {
   3.960547975828168*^9, 3.960547994092085*^9}, {3.960548207945209*^9, 
   3.960548246152244*^9}, {3.960548476144722*^9, 3.960548574633513*^9}, {
   3.9605486071092253`*^9, 3.960548670453143*^9}, {3.96054880256606*^9, 
   3.9605488110588837`*^9}, 3.9605488786478453`*^9, {3.9605597464468393`*^9, 
   3.960559765121984*^9}, {3.960561045631024*^9, 3.960561063713027*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"7c422bd2-6d77-4765-9e5b-47b734b1f5af"]
}, Closed]],

Cell[CellGroupData[{

Cell["4-Christoffel symbols", "Subsection",
 CellChangeTimes->{{3.960548918017743*^9, 
  3.960548939069742*^9}},ExpressionUUID->"69a941a0-7e07-47a2-9852-\
979bf8551d6c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\[CapitalGamma]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalGamma]", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], "*", 
       RowBox[{"Sum", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"gUU", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "s"}], "]"}], "]"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"gLL", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "j"}], "]"}], "]"}], ",", 
              RowBox[{"coordsU", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], " ", "]"}], "+", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"gLL", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"coordsU", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], " ", "]"}], "-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"gLL", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"coordsU", "[", 
               RowBox[{"[", "s", "]"}], "]"}]}], " ", "]"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", "4"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], " ", ";"}]}], "Input",
 CellChangeTimes->{{3.9541686173129587`*^9, 3.9541687707198277`*^9}, {
   3.95417232528426*^9, 3.954172327194663*^9}, {3.95417238764052*^9, 
   3.954172606185693*^9}, {3.954172659992856*^9, 3.954172707082992*^9}, {
   3.954173020759755*^9, 3.954173078831015*^9}, {3.954174294381667*^9, 
   3.954174317361146*^9}, {3.954174351461337*^9, 3.954174359616845*^9}, {
   3.95436137058225*^9, 3.9543613905557623`*^9}, {3.954361616286333*^9, 
   3.954361654783115*^9}, {3.9544115058348618`*^9, 3.954411518644565*^9}, {
   3.954411584390973*^9, 3.9544116804735737`*^9}, {3.955810409758565*^9, 
   3.955810445757955*^9}, {3.9558105108282948`*^9, 3.955810734961289*^9}, {
   3.95581078561799*^9, 3.955810959667181*^9}, {3.9558109915441504`*^9, 
   3.955811051578422*^9}, {3.955811120046208*^9, 3.955811178222454*^9}, {
   3.9558112214865713`*^9, 3.955811261497965*^9}, {3.955811337620902*^9, 
   3.95581134589882*^9}, {3.9558113856313143`*^9, 3.955811387965905*^9}, 
   3.955811426259285*^9, {3.955811461398423*^9, 3.9558114694046497`*^9}, {
   3.9558115449800043`*^9, 3.95581160957784*^9}, {3.955812213763946*^9, 
   3.955812508422171*^9}, {3.955812551272944*^9, 3.9558125555146503`*^9}, {
   3.955812588388248*^9, 3.9558126364451103`*^9}, {3.955812711319002*^9, 
   3.955812845309157*^9}, {3.955813452687645*^9, 3.9558134641770983`*^9}, {
   3.955813767329068*^9, 3.9558137894302807`*^9}, {3.955813826872389*^9, 
   3.955813907886932*^9}, {3.955985658522842*^9, 3.955985697124757*^9}, {
   3.955985739285636*^9, 3.955985739494197*^9}, 3.959858860971013*^9, 
   3.960298591850493*^9, 3.960548838058651*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"37e0ded1-1af6-4429-a863-997cbd78ad12"]
}, Closed]],

Cell[CellGroupData[{

Cell["Geodesic equation checker", "Subsection",
 CellChangeTimes->{{3.960549955822421*^9, 
  3.9605499598307877`*^9}},ExpressionUUID->"d4763089-f9f6-479f-a9a0-\
359ecb270085"],

Cell["Compute the geodesic equations from a 4-velocity vector", "Text",
 CellChangeTimes->{{3.9599787025179033`*^9, 3.959978704965681*^9}, {
  3.96055001281842*^9, 
  3.960550025222386*^9}},ExpressionUUID->"6823b57f-3052-4307-b79c-\
d32095c33084"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "geodesicEquations", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"geodesicEquations", "[", 
    RowBox[{"velU_", ",", "velL_"}], "]"}], ":=", 
   RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"velU", "[", 
           RowBox[{"[", "a", "]"}], "]"}], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"velL", "[", 
             RowBox[{"[", "b", "]"}], "]"}], ",", 
            RowBox[{"coordsU", "[", 
             RowBox[{"[", "a", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "1", ",", "4"}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", "-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"velU", "[", 
           RowBox[{"[", "a", "]"}], "]"}], 
          RowBox[{"\[CapitalGamma]", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "a", ",", "b"}], "]"}], "]"}], 
          RowBox[{"velL", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"b", ",", "1", ",", "4"}], "}"}]}], "\[IndentingNewLine]", 
     "]"}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9605499684372663`*^9, 3.960549994479692*^9}, {
  3.9605500329451637`*^9, 3.96055020910441*^9}, {3.9605502847181053`*^9, 
  3.9605502897416353`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"e90e3040-e2b9-48f1-b785-ee796988c557"]
}, Closed]],

Cell[CellGroupData[{

Cell["Curvature tensors and energy density", "Subsection",
 CellChangeTimes->{{3.9605489458859253`*^9, 3.960548950368799*^9}, {
  3.960549924753851*^9, 3.9605499283707113`*^9}, {3.960561978532896*^9, 
  3.96056198182095*^9}},ExpressionUUID->"72fcdbb7-5bc3-4db4-9651-\
42797cb1dd61"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "RiemannLLLL", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RiemannLLLL", "=", 
    RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"\[CapitalGamma]", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "l"}], "]"}], "]"}], ",", 
          RowBox[{"coordsU", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], " ", "]"}], "-", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"\[CapitalGamma]", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
          RowBox[{"coordsU", "[", 
           RowBox[{"[", "l", "]"}], "]"}]}], " ", "]"}], "+", 
        RowBox[{"Sum", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalGamma]", "[", 
             RowBox[{"[", 
              RowBox[{"s", ",", "j", ",", "l"}], "]"}], "]"}], " ", 
            RowBox[{"\[CapitalGamma]", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "k", ",", "s"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"\[CapitalGamma]", "[", 
             RowBox[{"[", 
              RowBox[{"s", ",", "j", ",", "k"}], "]"}], "]"}], " ", 
            RowBox[{"\[CapitalGamma]", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "l", ",", "s"}], "]"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", "4"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "4"}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "RicciLL", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RicciLL", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"RiemannLLLL", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j", ",", "i", ",", "l"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "4"}], "}"}]}], "]"}], " ", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "RicciScalar", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RicciScalar", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"gUU", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], 
        RowBox[{"RicciLL", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], " ", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "EinsteinLL", "]"}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"EinsteinLL", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"RicciLL", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], "RicciScalar", "*", "gLL"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "EnergyDensity", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"EnergyDensity", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"8", "\[Pi]"}], ")"}]}], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"EinsteinLL", "[", 
        RowBox[{"[", 
         RowBox[{"a", ",", "b"}], "]"}], "]"}], "*", 
       RowBox[{"nU", "[", 
        RowBox[{"[", "a", "]"}], "]"}], 
       RowBox[{"nU", "[", 
        RowBox[{"[", "b", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "1", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "]"}]}]}], "Input",\

 CellChangeTimes->{{3.9541686173129587`*^9, 3.9541687707198277`*^9}, {
   3.95417232528426*^9, 3.954172327194663*^9}, {3.95417238764052*^9, 
   3.954172606185693*^9}, {3.954172659992856*^9, 3.954172707082992*^9}, {
   3.954173020759755*^9, 3.954173078831015*^9}, {3.954174294381667*^9, 
   3.954174317361146*^9}, {3.954174351461337*^9, 3.954174359616845*^9}, {
   3.95436137058225*^9, 3.9543613905557623`*^9}, {3.954361616286333*^9, 
   3.954361654783115*^9}, {3.9544115058348618`*^9, 3.954411518644565*^9}, {
   3.954411584390973*^9, 3.9544116804735737`*^9}, {3.955810409758565*^9, 
   3.955810445757955*^9}, {3.9558105108282948`*^9, 3.955810734961289*^9}, {
   3.95581078561799*^9, 3.955810959667181*^9}, {3.9558109915441504`*^9, 
   3.955811051578422*^9}, {3.955811120046208*^9, 3.955811178222454*^9}, {
   3.9558112214865713`*^9, 3.955811261497965*^9}, {3.955811337620902*^9, 
   3.95581134589882*^9}, {3.9558113856313143`*^9, 3.955811387965905*^9}, 
   3.955811426259285*^9, {3.955811461398423*^9, 3.9558114694046497`*^9}, {
   3.9558115449800043`*^9, 3.95581160957784*^9}, {3.955812213763946*^9, 
   3.955812508422171*^9}, {3.955812551272944*^9, 3.9558125555146503`*^9}, {
   3.955812588388248*^9, 3.9558126364451103`*^9}, {3.955812711319002*^9, 
   3.955812845309157*^9}, {3.955813452687645*^9, 3.9558134641770983`*^9}, {
   3.955813767329068*^9, 3.9558137894302807`*^9}, {3.955813826872389*^9, 
   3.955813907886932*^9}, {3.955985658522842*^9, 3.955985697124757*^9}, {
   3.955985739285636*^9, 3.955985739494197*^9}, 3.959858860971013*^9, 
   3.960298591850493*^9, {3.960549907946477*^9, 
   3.960549908451442*^9}},ExpressionUUID->"51f8cb81-8be6-41c6-bfd6-\
e04d5412370f"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Vincent Geodesic equations", "Section",
 CellChangeTimes->{{3.960494252180924*^9, 
  3.9604942564508667`*^9}},ExpressionUUID->"29edda33-ca4d-4b75-8ae0-\
bf142411eef1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "VU", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VU", "=", 
    RowBox[{"{", 
     RowBox[{"velx", ",", "vely", ",", "velz"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "dXudt", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dXudt", "=", 
    RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"lapse", "*", 
         RowBox[{"VU", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "-", 
        RowBox[{"\[Beta]U", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "dVUdt", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dVUdt", "=", 
    RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"lapse", "*", 
           RowBox[{"VU", "[", 
            RowBox[{"[", "j", "]"}], "]"}], 
           RowBox[{"VU", "[", 
            RowBox[{"[", "i", "]"}], "]"}], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Log", "[", "lapse", "]"}], ",", 
             RowBox[{"scoordsU", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"lapse", "*", 
           RowBox[{"VU", "[", 
            RowBox[{"[", "j", "]"}], "]"}], 
           RowBox[{"VU", "[", 
            RowBox[{"[", "i", "]"}], "]"}], 
           RowBox[{"KLL", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "k"}], "]"}], "]"}], 
           RowBox[{"VU", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"2", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Alpha]", "[", 
             RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], 
            RowBox[{"VU", "[", 
             RowBox[{"[", "j", "]"}], "]"}], 
            RowBox[{"\[Gamma]UU", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "k"}], "]"}], "]"}], 
            RowBox[{"KLL", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "j"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Gamma]UU", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"\[Alpha]", "[", 
              RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
             RowBox[{"scoordsU", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"VU", "[", 
            RowBox[{"[", "j", "]"}], "]"}], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"\[Beta]U", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"scoordsU", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "dEdt", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dEdt", "=", 
   RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
    RowBox[{"energy", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"lapse", "*", 
          RowBox[{"KLL", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "k"}], "]"}], "]"}], 
          RowBox[{"VU", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"VU", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}], "-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"VU", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"D", "[", 
           RowBox[{"lapse", ",", 
            RowBox[{"scoordsU", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ")"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.960494339530059*^9, 3.960494455328616*^9}, {
  3.960495354886105*^9, 3.960495370981045*^9}, {3.960495419214192*^9, 
  3.960495443128892*^9}, {3.9604955073877487`*^9, 3.9604958276037817`*^9}, {
  3.9604958789485083`*^9, 3.960495957924842*^9}, {3.960496037385404*^9, 
  3.960496037799385*^9}, {3.960496468828856*^9, 3.9604965050690937`*^9}, {
  3.960496551123658*^9, 3.9604966626685143`*^9}, {3.960496796940155*^9, 
  3.9604967995366287`*^9}, {3.9604968471744833`*^9, 3.960496881485859*^9}, {
  3.960497048470435*^9, 3.960497098812261*^9}, {3.960497580622789*^9, 
  3.960497673131998*^9}, {3.9604977178390512`*^9, 3.960497776349986*^9}, {
  3.960498793890256*^9, 3.960498794617063*^9}, {3.960498914796235*^9, 
  3.960498965620308*^9}, {3.960550397968004*^9, 3.960550399880719*^9}, {
  3.960550633329192*^9, 3.9605506342971478`*^9}, {3.960560896631044*^9, 
  3.960561035172783*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"f99b543f-05d3-4afe-8079-3e334d178cc7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "vincentPU", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vincentPU", "=", 
    RowBox[{"energy", 
     RowBox[{"(", 
      RowBox[{"nU", "+", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", "VU"}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "vincentNorm", "]"}], "\[IndentingNewLine]", 
 RowBox[{"vincentNorm", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gLL", "[", 
          RowBox[{"[", 
           RowBox[{"a", ",", "b"}], "]"}], "]"}], 
         RowBox[{"vincentPU", "[", 
          RowBox[{"[", "a", "]"}], "]"}], 
         RowBox[{"vincentPU", "[", 
          RowBox[{"[", "b", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "1", ",", "4"}], "}"}]}], "]"}], "==", 
      RowBox[{"(", 
       RowBox[{"-", "\[Delta]"}], ")"}]}], ",", "energy"}], "]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9605001863192787`*^9, 3.9605004204993887`*^9}, 
   3.960500493470455*^9, 3.960500539750226*^9, {3.960500583125288*^9, 
   3.960500585383419*^9}, {3.960561109509663*^9, 3.960561181339663*^9}, 
   3.960892365137412*^9, {3.9608924603350353`*^9, 3.9608924607275887`*^9}, 
   3.960892653773653*^9},
 CellLabel->"In[42]:=",ExpressionUUID->"d727c731-087d-414c-9106-ce2df8f6f681"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"energy", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       SqrtBox["\[Delta]"], 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["velx", "2"], "-", 
         SuperscriptBox["vely", "2"], "-", 
         SuperscriptBox["velz", "2"]}]]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"energy", "\[Rule]", 
     FractionBox[
      SqrtBox["\[Delta]"], 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["velx", "2"], "-", 
        SuperscriptBox["vely", "2"], "-", 
        SuperscriptBox["velz", "2"]}]]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9605001873738117`*^9, {3.960500251274637*^9, 3.960500284395612*^9}, {
   3.960500324715975*^9, 3.960500337599431*^9}, {3.960500376658914*^9, 
   3.960500420935278*^9}, 3.960500494140484*^9, 3.96050054032193*^9, 
   3.9605005859646883`*^9, {3.960561113857782*^9, 3.960561182534754*^9}, 
   3.9608923657605753`*^9, 3.9608924660518847`*^9, 3.960892654284979*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"52d7b8d3-05d1-4a6d-bd30-4b25ffce0ee7"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Particle Hamiltonian", "Section",
 CellChangeTimes->{{3.9544115207259007`*^9, 3.9544115211452427`*^9}, {
  3.954411686099544*^9, 
  3.954411692839574*^9}},ExpressionUUID->"4d5fae55-4497-4e9d-b679-\
70837802b28e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "pL", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pL", "=", 
    RowBox[{"{", 
     RowBox[{"pt", ",", "px", ",", "py", ",", "pz"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "H", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gUU", "[", 
          RowBox[{"[", 
           RowBox[{"a", ",", "b"}], "]"}], "]"}], 
         RowBox[{"pL", "[", 
          RowBox[{"[", "a", "]"}], "]"}], 
         RowBox[{"pL", "[", 
          RowBox[{"[", "b", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "dHdpL", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dHdpL", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"H", ",", 
         RowBox[{"pL", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "dHdqU", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dHdqU", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"H", ",", 
         RowBox[{"coordsU", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "NormCons", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NormCons", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gUU", "[", 
          RowBox[{"[", 
           RowBox[{"a", ",", "b"}], "]"}], "]"}], 
         RowBox[{"pL", "[", 
          RowBox[{"[", "a", "]"}], "]"}], 
         RowBox[{"pL", "[", 
          RowBox[{"[", "b", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "1", ",", "4"}], "}"}]}], "]"}], "-", "\[Delta]"}],
      ",", "pt", ",", "FullSimplify"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.954411696533112*^9, 3.954411855977006*^9}, {
   3.954412632366378*^9, 3.954412651773281*^9}, {3.9544500056270742`*^9, 
   3.954450006440085*^9}, {3.955987619196903*^9, 3.955987759790354*^9}, 
   3.955987924117231*^9, {3.9598592175643787`*^9, 3.959859242128433*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"1c4919fb-3aeb-469d-9ab2-fc6040741e23"]
}, Closed]],

Cell[CellGroupData[{

Cell["Transition functions", "Section",
 CellChangeTimes->{{3.959980695802122*^9, 
  3.959980696455472*^9}},ExpressionUUID->"326122ec-0e9b-4867-b509-\
b12f97ba23b5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{"www", ".", "j"}], "-", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"raedler", ".", "de"}], "/", "2010"}], "/", "10"}], "/", 
      "smooth"}], "-", "transition", "-", "between", "-", "functions", "-", 
     "with", "-", "tanh"}]}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
      "Non"}], "-", 
     RowBox[{
     "analytic_smooth", "_function", "#Smooth", "_transition", 
      "_functions"}]}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"SNAf", ",", "SNAg", ",", "SNAh"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SNAf", "[", "x_", "]"}], ":=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "x"}], "]"}], ",", 
          RowBox[{"x", ">", "0"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"x", "<=", "0"}]}], "}"}]}], "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SNAg", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"SNAf", "[", "x", "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"SNAf", "[", "x", "]"}], "+", 
        RowBox[{"SNAf", "[", 
         RowBox[{"1", "-", "x"}], "]"}]}], ")"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SNAh", "[", 
      RowBox[{"xa_", ",", "xb_", ",", "x_"}], "]"}], ":=", 
     RowBox[{"SNAg", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", "xa"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"xb", "-", "xa"}], ")"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"ClearAll", "[", "CInfTransition", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CInfTransition", "[", 
      RowBox[{"x_", ",", "a_", ",", "xa_", ",", "b_", ",", "xb_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"b", "*", 
       RowBox[{"SNAh", "[", 
        RowBox[{"xa", ",", "xb", ",", "x"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"SNAh", "[", 
          RowBox[{"xa", ",", "xb", ",", "x"}], "]"}]}], ")"}], "a"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CInfTransition", "[", 
     RowBox[{"x_", ",", "y0_", ",", "x0_", ",", "\[CapitalDelta]x_"}], "]"}], 
    "=", 
    RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CInfTransition", "[", 
       RowBox[{"x", ",", "y0", ",", "x0", ",", "0", ",", 
        RowBox[{"x0", "+", "\[CapitalDelta]x"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", "\[Element]", "Reals"}], ",", "\[IndentingNewLine]", 
        RowBox[{"y0", "\[Element]", "Reals"}], ",", "\[IndentingNewLine]", 
        RowBox[{"x0", "\[Element]", "Reals"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]x", "\[Element]", "Reals"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"x", ">=", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]x", ">", "0"}]}], "\[IndentingNewLine]", 
       "}"}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.955986507478323*^9, 3.955986545371977*^9}, {
  3.959980716352003*^9, 3.959980717410013*^9}, {3.959980794497847*^9, 
  3.959980821392157*^9}, {3.9599808640327997`*^9, 3.9599811872421207`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"aaea7e6b-10ca-460b-a584-e60e9aeeb799"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        FractionBox["y0", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[CapitalDelta]x", " ", 
            RowBox[{"(", 
             RowBox[{
              FractionBox["1", 
               RowBox[{
                RowBox[{"-", "x"}], "+", "x0"}]], "+", 
              FractionBox["1", 
               RowBox[{
                RowBox[{"-", "x"}], "+", "x0", "+", "\[CapitalDelta]x"}]]}], 
             ")"}]}]]}]], 
        RowBox[{
         RowBox[{"x", ">", "x0"}], "&&", 
         RowBox[{"x", "<", 
          RowBox[{"x0", "+", "\[CapitalDelta]x"}]}]}]},
       {"0", 
        RowBox[{"x", ">", "x0"}]},
       {"y0", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.9599809625565443`*^9, {3.95998102662789*^9, 3.959981055258952*^9}, 
   3.9599810952702017`*^9, {3.959981174733226*^9, 3.959981188663849*^9}, 
   3.960026376592524*^9, 3.960324089724124*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"085a782b-f401-48e8-9f08-27de1c95a9a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Derivative", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "[", 
     "CInfTransition", "]"}], "[", 
    RowBox[{"x", ",", "y0", ",", "x0", ",", "\[CapitalDelta]x"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", "\[Element]", "Reals"}], ",", "\[IndentingNewLine]", 
     RowBox[{"y0", "\[Element]", "Reals"}], ",", "\[IndentingNewLine]", 
     RowBox[{"x0", "\[Element]", "Reals"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]x", "\[Element]", "Reals"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"x", ">=", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]x", ">", "0"}]}], "\[IndentingNewLine]", "}"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.959981307742298*^9, 3.959981335809023*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"71a826b6-ca30-43de-9d88-4eca31919ae0"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[CapitalDelta]x", " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", 
                RowBox[{
                 RowBox[{"-", "x"}], "+", "x0"}]], "+", 
               FractionBox["1", 
                RowBox[{
                 RowBox[{"-", "x"}], "+", "x0", "+", "\[CapitalDelta]x"}]]}], 
              ")"}]}]], " ", "y0", " ", "\[CapitalDelta]x", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x", "-", "x0"}], ")"}], "2"]], "+", 
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "x"}], "+", "x0", "+", "\[CapitalDelta]x"}], 
                ")"}], "2"]]}], ")"}]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[CapitalDelta]x", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"-", "x"}], "+", "x0"}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"-", "x"}], "+", "x0", "+", 
                   "\[CapitalDelta]x"}]]}], ")"}]}]]}], ")"}], "2"]]}], 
        RowBox[{
         RowBox[{"x", ">", "x0"}], "&&", 
         RowBox[{"x", "<", 
          RowBox[{"x0", "+", "\[CapitalDelta]x"}]}]}]},
       {"0", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{{3.9599813206212587`*^9, 3.959981339896315*^9}, 
   3.960026378987159*^9, 3.960324091942025*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"71784638-1666-44a2-8581-8dda5d389735"]
}, Open  ]],

Cell["\<\
This transformation is necessary, otherwise the exponentials blow up when \
computing this numerically\
\>", "Text",
 CellChangeTimes->{{3.9600279289507427`*^9, 
  3.9600279518417797`*^9}},ExpressionUUID->"b367dce0-df8e-417a-aea7-\
34b641ea2a7a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpToTrig", "[", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[CapitalDelta]x", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"-", "x"}], "+", "x0"}]], "+", 
          FractionBox["1", 
           RowBox[{
            RowBox[{"-", "x"}], "+", "x0", "+", "\[CapitalDelta]x"}]]}], 
         ")"}]}]], " ", "y0", " ", "\[CapitalDelta]x", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "x0"}], ")"}], "2"]], "+", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x"}], "+", "x0", "+", "\[CapitalDelta]x"}], ")"}], 
          "2"]]}], ")"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[CapitalDelta]x", " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              RowBox[{"-", "x"}], "+", "x0"}]], "+", 
            FractionBox["1", 
             RowBox[{
              RowBox[{"-", "x"}], "+", "x0", "+", "\[CapitalDelta]x"}]]}], 
           ")"}]}]]}], ")"}], "2"]]}], "]"}], "//", "FullSimplify"}]], "Input",\

 CellChangeTimes->{{3.960027106341907*^9, 3.960027197030568*^9}, {
  3.960027280288331*^9, 3.96002734953531*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"8d3fbc53-bc3a-4c7a-9c20-d24852cc8b71"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"y0", " ", "\[CapitalDelta]x", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x", "-", "x0"}], ")"}], "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "x"}], "+", "x0"}], ")"}], " ", "\[CapitalDelta]x"}], "+", 
      SuperscriptBox["\[CapitalDelta]x", "2"]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"Sech", "[", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[CapitalDelta]x", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           RowBox[{"-", "x"}], "+", "x0"}]], "+", 
         FractionBox["1", 
          RowBox[{
           RowBox[{"-", "x"}], "+", "x0", "+", "\[CapitalDelta]x"}]]}], 
        ")"}]}], "]"}], "2"]}], 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x", "-", "x0"}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "x"}], "+", "x0", "+", "\[CapitalDelta]x"}], ")"}], 
     "2"]}]]}]], "Output",
 CellChangeTimes->{{3.960027117559527*^9, 3.960027128073243*^9}, {
  3.960027169535448*^9, 3.960027197837427*^9}, {3.9600272856273193`*^9, 
  3.960027291363675*^9}, {3.960027323547456*^9, 3.960027350030212*^9}},
 CellLabel->"Out[20]=",ExpressionUUID->"6dc6e26c-a91a-42e7-847f-2a7fba3ce3ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"y0", " ", "\[CapitalDelta]x", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "x0"}], ")"}], "2"]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x"}], "+", "x0"}], ")"}], " ", "\[CapitalDelta]x"}], 
        "+", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"Sech", "[", 
        RowBox[{
         FractionBox["1", "2"], " ", "\[CapitalDelta]x", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            RowBox[{
             RowBox[{"-", "x"}], "+", "x0"}]], "+", 
           FractionBox["1", 
            RowBox[{
             RowBox[{"-", "x"}], "+", "x0", "+", "\[CapitalDelta]x"}]]}], 
          ")"}]}], "]"}], "2"]}], 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x", "-", "x0"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "x"}], "+", "x0", "+", "\[CapitalDelta]x"}], ")"}], 
       "2"]}]], ",", "x"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.960303531191969*^9, 3.960303531339964*^9}, {
  3.960324099568503*^9, 3.9603241120409822`*^9}, {3.96032948423941*^9, 
  3.960329502695649*^9}},ExpressionUUID->"b2ca9664-48c2-4412-91c1-\
11a8d6c17da9"],

Cell[BoxData[
 FractionBox[
  RowBox[{"y0", " ", "\[CapitalDelta]x", " ", 
   SuperscriptBox[
    RowBox[{"Sech", "[", 
     RowBox[{
      FractionBox["1", "2"], " ", "\[CapitalDelta]x", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         RowBox[{
          RowBox[{"-", "x"}], "+", "x0"}]], "+", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"-", "x"}], "+", "x0", "+", "\[CapitalDelta]x"}]]}], 
       ")"}]}], "]"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "x"}], "-", 
        RowBox[{"2", " ", "x0"}], "-", "\[CapitalDelta]x"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "-", "x0"}], ")"}], "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x"}], "+", "x0"}], ")"}], " ", "\[CapitalDelta]x"}], 
        "+", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{"\[CapitalDelta]x", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "-", "x0"}], ")"}], "2"]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "x"}], "+", "x0"}], ")"}], " ", 
           "\[CapitalDelta]x"}], "+", 
          SuperscriptBox["\[CapitalDelta]x", "2"]}], ")"}], "2"], " ", 
       RowBox[{"Tanh", "[", 
        RowBox[{
         FractionBox["1", "2"], " ", "\[CapitalDelta]x", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            RowBox[{
             RowBox[{"-", "x"}], "+", "x0"}]], "+", 
           FractionBox["1", 
            RowBox[{
             RowBox[{"-", "x"}], "+", "x0", "+", "\[CapitalDelta]x"}]]}], 
          ")"}]}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", "x0"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"x", "-", "x0", "-", "\[CapitalDelta]x"}], ")"}]}]]}], 
    ")"}]}], 
  RowBox[{"4", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"x", "-", "x0"}], ")"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "x"}], "+", "x0", "+", "\[CapitalDelta]x"}], ")"}], 
    "3"]}]]], "Output",
 CellChangeTimes->{{3.960324102796235*^9, 3.960324113318564*^9}},
 CellLabel->"Out[22]=",ExpressionUUID->"1c2c3262-73b8-4975-b630-ca9c25b2806c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToString", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"y0", " ", "\[CapitalDelta]x", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x", "-", "x0"}], ")"}], "2"]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "x"}], "+", "x0"}], ")"}], " ", 
            "\[CapitalDelta]x"}], "+", 
           SuperscriptBox["\[CapitalDelta]x", "2"]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Sech", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", "\[CapitalDelta]x", " ", 
            RowBox[{"(", 
             RowBox[{
              FractionBox["1", 
               RowBox[{
                RowBox[{"-", "x"}], "+", "x0"}]], "+", 
              FractionBox["1", 
               RowBox[{
                RowBox[{"-", "x"}], "+", "x0", "+", "\[CapitalDelta]x"}]]}], 
             ")"}]}], "]"}], "2"]}], 
        RowBox[{"4", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", "x0"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x"}], "+", "x0", "+", "\[CapitalDelta]x"}], ")"}], 
          "2"]}]], ",", "x"}], "]"}], "//.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x0", "-", "x"}], ")"}], "->", "x1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x1", "+", "\[CapitalDelta]x"}], ")"}], "->", "x2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalDelta]x", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"1", "/", "x1"}], "+", 
           RowBox[{"1", "/", "x2"}]}], ")"}]}], "->", "x3"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "x0"}], ")"}], "->", "x4"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Sech", "[", "x3", "]"}], "->", "x5"}]}], 
      "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", "CForm"}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.960329527860544*^9, 3.960329629432481*^9}, {
  3.960329661536191*^9, 3.960329668838975*^9}, {3.96032990352147*^9, 
  3.960329911589842*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"d9db31f1-9440-4c77-83dd-ce906c6f26e3"],

Cell[BoxData["\<\"-0.25*(x5*x5*y0*\[CapitalDelta]x*(2*(x1*x1)*x2*(-2*powi(x4,\
3) + x4*(-2*x1 + x2 - \[CapitalDelta]x)*\[CapitalDelta]x + \
x2*\[CapitalDelta]x*(2*x1 + \[CapitalDelta]x)) + (x1*x1 + x2*x2)*x4*\
\[CapitalDelta]x*(2*(x4*x4) + \[CapitalDelta]x*(2*x1 + \
\[CapitalDelta]x))*Tanh(x3)))/(x1*x1*powi(x2,4)*powi(x4,3))\"\>"], "Output",
 CellChangeTimes->{{3.960329554129558*^9, 3.9603296311597357`*^9}, 
   3.960329670895084*^9, 3.9603299122999287`*^9},
 CellLabel->
  "Out[240]=",ExpressionUUID->"4fcfe856-c079-442e-9d62-23ec638f088b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Code strings", "Section",
 CellChangeTimes->{
  3.9559874838707933`*^9},ExpressionUUID->"7e2614e4-3ccc-413f-b1ab-\
5730391be272"],

Cell[CellGroupData[{

Cell["Proper formatting of Power", "Subsection",
 CellChangeTimes->{{3.955988608424461*^9, 3.955988613150982*^9}, {
  3.9609114862517567`*^9, 
  3.960911488365404*^9}},ExpressionUUID->"d85fc119-c9ed-489e-95a7-\
d5fd37db53c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "Power", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{"E", ",", "a_"}], "]"}], ",", "CForm"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"exp", "[", "a", "]"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"1", "/", "2"}]}], "]"}], ",", "CForm"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"sqrt", "[", "a", "]"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{"a_", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}], "]"}], ",", "CForm"}], "]"}], ":=", 
   
   RowBox[{"(", 
    RowBox[{"1", "/", 
     RowBox[{"sqrt", "[", "a", "]"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"3", "/", "2"}]}], "]"}], ",", "CForm"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"a", "*", 
     RowBox[{"sqrt", "[", "a", "]"}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{"a_", ",", "2"}], "]"}], ",", "CForm"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"HoldForm", "[", 
     RowBox[{"a", "*", "a"}], "]"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", "CForm"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"HoldForm", "[", 
     RowBox[{"1", "/", 
      RowBox[{"(", "a", ")"}]}], "]"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{"a_", ",", 
       RowBox[{"-", "2"}]}], "]"}], ",", "CForm"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"HoldForm", "[", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", "a", ")"}], "*", 
        RowBox[{"(", "a", ")"}]}], ")"}]}], "]"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{"a_", ",", "b_"}], "]"}], ",", "CForm"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"powi", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ")"}], "/;", 
    RowBox[{"b", "\[Element]", "Integers"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"Power", "[", 
      RowBox[{"a_", ",", "b_"}], "]"}], ",", "CForm"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"powf", "[", 
     RowBox[{"a", ",", "b"}], "]"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "Power", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.955990589892071*^9, 3.9559905981056223`*^9}, {
  3.955990628109312*^9, 3.9559906340540247`*^9}, {3.955991016709017*^9, 
  3.955991019506207*^9}, {3.956159811459832*^9, 3.956159847792693*^9}, {
  3.959434780679373*^9, 3.959434806599037*^9}, {3.9599626012786007`*^9, 
  3.9599626090448523`*^9}, {3.959962643361821*^9, 3.9599626639250507`*^9}, {
  3.9599629286676292`*^9, 3.9599629349206257`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"5ab1d630-79da-404b-9017-f8b13b69a140"]
}, Closed]],

Cell[CellGroupData[{

Cell["Vincent equations RHS", "Subsection",
 CellChangeTimes->{{3.96049692198984*^9, 
  3.960496925203432*^9}},ExpressionUUID->"d572e0a5-9b76-41a8-a2c2-\
0b60b0081191"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "rules", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rules", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"vx", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "->", "lvx"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vy", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "->", "lvy"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vz", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "->", "lvz"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "x"}], 
        "]"}], "->", "dvxdx"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "y"}], 
        "]"}], "->", "dvxdy"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "z"}], 
        "]"}], "->", "dvxdz"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"vy", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "x"}], 
        "]"}], "->", "dvydx"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"vy", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "y"}], 
        "]"}], "->", "dvydy"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"vy", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "z"}], 
        "]"}], "->", "dvydz"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"vz", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "x"}], 
        "]"}], "->", "dvzdx"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"vz", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "y"}], 
        "]"}], "->", "dvzdy"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"vz", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "z"}], 
        "]"}], "->", "dvzdz"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Alpha]", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "->", "lalp"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Alpha]", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "x"}], 
        "]"}], "->", "dalpdx"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Alpha]", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "y"}], 
        "]"}], "->", "dalpdy"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Alpha]", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", "z"}], 
        "]"}], "->", "dalpdz"}]}], "\n", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "stringRules", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stringRules", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"\"\<powi\>\"", "->", "\"\<f64::powi\>\""}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<let dx_dt = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{"dXudt", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "//.", "rules"}], "]"}], ",", 
        "CForm"}], "]"}], ",", "stringRules"}], "]"}], ",", "\"\<;\\n\>\""}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<let dy_dt = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{"dXudt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "//.", "rules"}], "]"}], ",", 
        "CForm"}], "]"}], ",", "stringRules"}], "]"}], ",", "\"\<;\\n\>\""}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<let dz_dt = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{"dXudt", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "//.", "rules"}], "]"}], ",", 
        "CForm"}], "]"}], ",", "stringRules"}], "]"}], ",", "\"\<;\\n\>\""}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<let dvelx_dt = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{"dVUdt", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "//.", "rules"}], "]"}], ",", 
        "CForm"}], "]"}], ",", "stringRules"}], "]"}], ",", "\"\<;\\n\>\""}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<let dvely_dt = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{"dVUdt", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "//.", "rules"}], "]"}], ",", 
        "CForm"}], "]"}], ",", "stringRules"}], "]"}], ",", "\"\<;\\n\>\""}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<let dvelz_dt = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{"dVUdt", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "//.", "rules"}], "]"}], ",", 
        "CForm"}], "]"}], ",", "stringRules"}], "]"}], ",", "\"\<;\\n\>\""}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<let denergy_dt = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{
        RowBox[{"FullSimplify", "[", 
         RowBox[{"dEdt", "//.", "rules"}], "]"}], ",", "CForm"}], "]"}], ",", 
      "stringRules"}], "]"}], ",", "\"\<;\>\""}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "rules", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "stringRules", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9604969454385767`*^9, 3.960497028471754*^9}, {
  3.960497140890642*^9, 3.9604971796352777`*^9}, {3.960497231688628*^9, 
  3.960497325789398*^9}, {3.9604973993613577`*^9, 3.960497402049594*^9}, {
  3.9604977847891283`*^9, 3.960497797854252*^9}, {3.960498235352621*^9, 
  3.960498278503817*^9}, {3.960498590470316*^9, 3.9604986020570583`*^9}, {
  3.960498739254884*^9, 3.960498762163233*^9}, {3.9604988867961483`*^9, 
  3.960498901121614*^9}, {3.960498975922646*^9, 3.960498990141982*^9}, {
  3.960561247615406*^9, 3.9605613915217237`*^9}, {3.960561547362061*^9, 
  3.9605615477431793`*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"1c7d7c67-22cd-4dfb-af84-1f0ae61fb60f"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"let dx_dt = \"\>", 
   "\[InvisibleSpace]", "\<\"lvx + lalp*velx\"\>", 
   "\[InvisibleSpace]", "\<\";\\n\"\>"}],
  SequenceForm["let dx_dt = ", "lvx + lalp*velx", ";\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.96056134689939*^9, 3.960561403862475*^9, 
  3.960561550136183*^9},
 CellLabel->
  "During evaluation of \
In[231]:=",ExpressionUUID->"87e5f5b2-4753-4491-b946-b21139741063"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"let dy_dt = \"\>", 
   "\[InvisibleSpace]", "\<\"lvy + lalp*vely\"\>", 
   "\[InvisibleSpace]", "\<\";\\n\"\>"}],
  SequenceForm["let dy_dt = ", "lvy + lalp*vely", ";\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.96056134689939*^9, 3.960561403862475*^9, 
  3.960561550139266*^9},
 CellLabel->
  "During evaluation of \
In[231]:=",ExpressionUUID->"c687123d-69ee-4825-a81a-0b742c039a92"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"let dz_dt = \"\>", 
   "\[InvisibleSpace]", "\<\"lvz + lalp*velz\"\>", 
   "\[InvisibleSpace]", "\<\";\\n\"\>"}],
  SequenceForm["let dz_dt = ", "lvz + lalp*velz", ";\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.96056134689939*^9, 3.960561403862475*^9, 
  3.960561550143743*^9},
 CellLabel->
  "During evaluation of \
In[231]:=",ExpressionUUID->"db2b0954-5e2f-4a49-ad35-3fcd9f97e216"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"let dvelx_dt = \"\>", 
   "\[InvisibleSpace]", "\<\"dalpdx*(-1 + velx*velx) - dvydx*vely - \
dvzdx*velz + velx*(dvxdx*(-1 + velx*velx) + vely*(dalpdy + (dvxdy + \
dvydx)*velx + dvydy*vely) + (dalpdz + (dvxdz + dvzdx)*velx + (dvydz + \
dvzdy)*vely)*velz + dvzdz*(velz*velz))\"\>", 
   "\[InvisibleSpace]", "\<\";\\n\"\>"}],
  SequenceForm[
  "let dvelx_dt = ", 
   "dalpdx*(-1 + velx*velx) - dvydx*vely - dvzdx*velz + velx*(dvxdx*(-1 + \
velx*velx) + vely*(dalpdy + (dvxdy + dvydx)*velx + dvydy*vely) + (dalpdz + \
(dvxdz + dvzdx)*velx + (dvydz + dvzdy)*vely)*velz + dvzdz*(velz*velz))", 
   ";\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.96056134689939*^9, 3.960561403862475*^9, 
  3.960561550146454*^9},
 CellLabel->
  "During evaluation of \
In[231]:=",ExpressionUUID->"6b623966-77b6-459a-b92f-ad1013dba3ba"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"let dvely_dt = \"\>", 
   "\[InvisibleSpace]", "\<\"dalpdy*(-1 + vely*vely) + dvxdy*velx*(-1 + \
vely*vely) - dvzdy*velz + vely*(dvydy*(-1 + vely*vely) + dalpdz*velz + (dvydz \
+ dvzdy)*vely*velz + dvzdz*(velz*velz) + velx*(dalpdx + dvxdx*velx + \
dvydx*vely + (dvxdz + dvzdx)*velz))\"\>", 
   "\[InvisibleSpace]", "\<\";\\n\"\>"}],
  SequenceForm[
  "let dvely_dt = ", 
   "dalpdy*(-1 + vely*vely) + dvxdy*velx*(-1 + vely*vely) - dvzdy*velz + \
vely*(dvydy*(-1 + vely*vely) + dalpdz*velz + (dvydz + dvzdy)*vely*velz + \
dvzdz*(velz*velz) + velx*(dalpdx + dvxdx*velx + dvydx*vely + (dvxdz + \
dvzdx)*velz))", ";\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.96056134689939*^9, 3.960561403862475*^9, 
  3.9605615501498013`*^9},
 CellLabel->
  "During evaluation of \
In[231]:=",ExpressionUUID->"6a634b90-19c4-40db-965a-991900af6c18"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"let dvelz_dt = \"\>", 
   "\[InvisibleSpace]", "\<\"-dalpdz - dvxdz*velx - dvydz*vely + (-dvzdz + \
velx*(dalpdx + dvxdx*velx))*velz + vely*(dalpdy + (dvxdy + dvydx)*velx + \
dvydy*vely)*velz + (dalpdz + (dvxdz + dvzdx)*velx + (dvydz + \
dvzdy)*vely)*(velz*velz) + dvzdz*f64::powi(velz,3)\"\>", 
   "\[InvisibleSpace]", "\<\";\\n\"\>"}],
  SequenceForm[
  "let dvelz_dt = ", 
   "-dalpdz - dvxdz*velx - dvydz*vely + (-dvzdz + velx*(dalpdx + \
dvxdx*velx))*velz + vely*(dalpdy + (dvxdy + dvydx)*velx + dvydy*vely)*velz + \
(dalpdz + (dvxdz + dvzdx)*velx + (dvydz + dvzdy)*vely)*(velz*velz) + \
dvzdz*f64::powi(velz,3)", ";\n"],
  Editable->False]], "Print",
 CellChangeTimes->{3.96056134689939*^9, 3.960561403862475*^9, 
  3.9605615501531277`*^9},
 CellLabel->
  "During evaluation of \
In[231]:=",ExpressionUUID->"0870b48a-7f13-4058-a15d-9b958057008b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"let denergy_dt = \"\>", 
   "\[InvisibleSpace]", "\<\"-(energy*(dalpdx*velx + dvxdx*(velx*velx) + \
vely*(dalpdy + (dvxdy + dvydx)*velx + dvydy*vely) + (dalpdz + (dvxdz + \
dvzdx)*velx + (dvydz + dvzdy)*vely)*velz + dvzdz*(velz*velz)))\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "let denergy_dt = ", 
   "-(energy*(dalpdx*velx + dvxdx*(velx*velx) + vely*(dalpdy + (dvxdy + \
dvydx)*velx + dvydy*vely) + (dalpdz + (dvxdz + dvzdx)*velx + (dvydz + \
dvzdy)*vely)*velz + dvzdz*(velz*velz)))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{3.96056134689939*^9, 3.960561403862475*^9, 
  3.96056155015659*^9},
 CellLabel->
  "During evaluation of \
In[231]:=",ExpressionUUID->"fc487a09-2abd-4e33-b1a2-3ca59168aca6"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Radius functions and derivatives", "Subsection",
 CellChangeTimes->{{3.9559898090755796`*^9, 
  3.955989815698574*^9}},ExpressionUUID->"cd6e1167-e4ac-4957-897a-\
b7eb9f8d4e09"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "strRules", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"strRules", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<u\>\"", "->", "\"\<self.u\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<sqrt\>\"", "->", "\"\<f64::sqrt\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<epsilon\>\"", "->", "\"\<self.epsilon\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<deltau\>\"", "->", "\"\<self.delta_u\>\""}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "r", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "=", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", 
         RowBox[{"u", "*", "t"}], "+", "deltau"}], ")"}], "^", "2"}], "+", 
      RowBox[{"y", "^", "2"}], "+", 
      RowBox[{"z", "^", "2"}], "+", "epsilon"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<r = \>\"", ",", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"r", ",", "CForm"}], "]"}], ",", "strRules"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<d_r_dt = \>\"", ",", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{"r", ",", "t"}], "]"}], "]"}], ",", "CForm"}], "]"}], ",", 
     "strRules"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<d_r_dx = \>\"", ",", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{"r", ",", "x"}], "]"}], "]"}], ",", "CForm"}], "]"}], ",", 
     "strRules"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<d_r_dy = \>\"", ",", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{"r", ",", "y"}], "]"}], "]"}], ",", "CForm"}], "]"}], ",", 
     "strRules"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<d_r_dz = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{
        RowBox[{"FullSimplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{"r", ",", "z"}], "]"}], "]"}], ",", "CForm"}], "]"}], ",", 
      "strRules"}], "]"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "r", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "strRules", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.95598983578517*^9, 3.955989850773065*^9}, {
  3.955989894225443*^9, 3.955989985049794*^9}, {3.95599034953755*^9, 
  3.9559903754741*^9}, {3.9560711425619287`*^9, 3.956071145859186*^9}, {
  3.956073899428523*^9, 3.956073910266498*^9}, {3.956159688336073*^9, 
  3.95615976156208*^9}, {3.959434106633292*^9, 3.95943410950821*^9}, {
  3.9599626825347157`*^9, 3.959962728750773*^9}, {3.959990437286563*^9, 
  3.959990602764049*^9}, {3.960903410253345*^9, 3.960903438427527*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"98330ef6-fd15-4c22-b993-752312922d08"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"r = \"\>", 
   "\[InvisibleSpace]", "\<\"f64::sqrt(self.epsilon + (self.delta_u - \
t*self.u + x)*(self.delta_u - t*self.u + x) + y*y + z*z)\"\>"}],
  SequenceForm[
  "r = ", "f64::sqrt(self.epsilon + (self.delta_u - t*self.u + \
x)*(self.delta_u - t*self.u + x) + y*y + z*z)"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9599627297287197`*^9, 3.9599629582955437`*^9, {3.959990439524826*^9, 
   3.9599904659937477`*^9}, {3.9599905238988457`*^9, 3.959990603316041*^9}, 
   3.960029996068185*^9, 3.9609034718039417`*^9},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"7635ec5c-5f90-4243-8155-efba75190da7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"d_r_dt = \"\>", 
   "\[InvisibleSpace]", "\<\"-((self.u*(self.delta_u - t*self.u + \
x))/f64::sqrt(self.epsilon + (self.delta_u - t*self.u + x)*(self.delta_u - \
t*self.u + x) + y*y + z*z))\"\>"}],
  SequenceForm[
  "d_r_dt = ", 
   "-((self.u*(self.delta_u - t*self.u + x))/f64::sqrt(self.epsilon + \
(self.delta_u - t*self.u + x)*(self.delta_u - t*self.u + x) + y*y + z*z))"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9599627297287197`*^9, 3.9599629582955437`*^9, {3.959990439524826*^9, 
   3.9599904659937477`*^9}, {3.9599905238988457`*^9, 3.959990603316041*^9}, 
   3.960029996068185*^9, 3.960903472057151*^9},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"9324e092-8cd7-4f67-9020-50e2068e1156"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"d_r_dx = \"\>", 
   "\[InvisibleSpace]", "\<\"(self.delta_u - t*self.u + \
x)/f64::sqrt(self.epsilon + (self.delta_u - t*self.u + x)*(self.delta_u - \
t*self.u + x) + y*y + z*z)\"\>"}],
  SequenceForm[
  "d_r_dx = ", 
   "(self.delta_u - t*self.u + x)/f64::sqrt(self.epsilon + (self.delta_u - \
t*self.u + x)*(self.delta_u - t*self.u + x) + y*y + z*z)"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9599627297287197`*^9, 3.9599629582955437`*^9, {3.959990439524826*^9, 
   3.9599904659937477`*^9}, {3.9599905238988457`*^9, 3.959990603316041*^9}, 
   3.960029996068185*^9, 3.9609034722419987`*^9},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"10a0666c-ae06-415c-b499-2497cc0cb6d5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"d_r_dy = \"\>", 
   "\[InvisibleSpace]", "\<\"y/f64::sqrt(self.epsilon + (self.delta_u - \
t*self.u + x)*(self.delta_u - t*self.u + x) + y*y + z*z)\"\>"}],
  SequenceForm[
  "d_r_dy = ", 
   "y/f64::sqrt(self.epsilon + (self.delta_u - t*self.u + x)*(self.delta_u - \
t*self.u + x) + y*y + z*z)"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9599627297287197`*^9, 3.9599629582955437`*^9, {3.959990439524826*^9, 
   3.9599904659937477`*^9}, {3.9599905238988457`*^9, 3.959990603316041*^9}, 
   3.960029996068185*^9, 3.960903472243313*^9},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"cba8a436-2ac1-4e5c-be38-863d04109196"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"d_r_dz = \"\>", 
   "\[InvisibleSpace]", "\<\"z/f64::sqrt(self.epsilon + (self.delta_u - \
t*self.u + x)*(self.delta_u - t*self.u + x) + y*y + z*z)\"\>"}],
  SequenceForm[
  "d_r_dz = ", 
   "z/f64::sqrt(self.epsilon + (self.delta_u - t*self.u + x)*(self.delta_u - \
t*self.u + x) + y*y + z*z)"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9599627297287197`*^9, 3.9599629582955437`*^9, {3.959990439524826*^9, 
   3.9599904659937477`*^9}, {3.9599905238988457`*^9, 3.959990603316041*^9}, 
   3.960029996068185*^9, 3.960903472244261*^9},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"9c05e06d-8dcb-4881-aed4-340094825600"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "strRules", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"strRules", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<u\>\"", "->", "\"\<self.u\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<sqrt\>\"", "->", "\"\<f64::sqrt\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<epsilon\>\"", "->", "\"\<self.epsilon\>\""}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "r", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "=", 
    RowBox[{"y", "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"y", "^", "2"}], "+", 
       RowBox[{"z", "^", "2"}], "+", "epsilon"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<r = \>\"", ",", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"r", ",", "CForm"}], "]"}], ",", "strRules"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<d_rho_y_dt = \>\"", ",", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{"r", ",", "t"}], "]"}], "]"}], ",", "CForm"}], "]"}], ",", 
     "strRules"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<d_rho_y_dx = \>\"", ",", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{"r", ",", "x"}], "]"}], "]"}], ",", "CForm"}], "]"}], ",", 
     "strRules"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<d_rho_y_dy = \>\"", ",", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{"r", ",", "y"}], "]"}], "]"}], ",", "CForm"}], "]"}], ",", 
     "strRules"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<d_rho_y_dz = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{
        RowBox[{"FullSimplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{"r", ",", "z"}], "]"}], "]"}], ",", "CForm"}], "]"}], ",", 
      "strRules"}], "]"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "r", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "strRules", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.955990074728956*^9, 3.955990103701661*^9}, {
   3.955990272407291*^9, 3.955990279580409*^9}, {3.955990659638734*^9, 
   3.955990668566904*^9}, {3.9560708558186197`*^9, 3.9560708840273037`*^9}, {
   3.956072342640418*^9, 3.956072361448793*^9}, {3.9561605444872103`*^9, 
   3.956160615171248*^9}, 3.959962753871848*^9, {3.959990678213076*^9, 
   3.959990694223783*^9}, {3.9600300089887943`*^9, 3.960030020834391*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"48a69f2a-9f4b-4923-9b37-591699f31280"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"r = \"\>", 
   "\[InvisibleSpace]", "\<\"y/f64::sqrt(self.epsilon + y*y + z*z)\"\>"}],
  SequenceForm["r = ", "y/f64::sqrt(self.epsilon + y*y + z*z)"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.959962754403612*^9, 3.9599629612489233`*^9, {3.959990684310096*^9, 
   3.959990695057756*^9}, 3.9600300222691174`*^9},
 CellLabel->
  "During evaluation of \
In[23]:=",ExpressionUUID->"e0839937-1825-4da5-adec-cc1e7e38712d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"d_rho_y_dt = \"\>", "\[InvisibleSpace]", "\<\"0\"\>"}],
  SequenceForm["d_rho_y_dt = ", "0"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.959962754403612*^9, 3.9599629612489233`*^9, {3.959990684310096*^9, 
   3.959990695057756*^9}, 3.960030022269907*^9},
 CellLabel->
  "During evaluation of \
In[23]:=",ExpressionUUID->"06528c16-05c4-4356-ab63-652d186a682a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"d_rho_y_dx = \"\>", "\[InvisibleSpace]", "\<\"0\"\>"}],
  SequenceForm["d_rho_y_dx = ", "0"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.959962754403612*^9, 3.9599629612489233`*^9, {3.959990684310096*^9, 
   3.959990695057756*^9}, 3.960030022270871*^9},
 CellLabel->
  "During evaluation of \
In[23]:=",ExpressionUUID->"3feeb4f6-87f4-4c57-8206-9dcf6c2a43ef"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"d_rho_y_dy = \"\>", 
   "\[InvisibleSpace]", "\<\"(self.epsilon + z*z)/((self.epsilon + y*y + \
z*z)*f64::sqrt(self.epsilon + y*y + z*z))\"\>"}],
  SequenceForm[
  "d_rho_y_dy = ", 
   "(self.epsilon + z*z)/((self.epsilon + y*y + z*z)*f64::sqrt(self.epsilon + \
y*y + z*z))"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.959962754403612*^9, 3.9599629612489233`*^9, {3.959990684310096*^9, 
   3.959990695057756*^9}, 3.960030022271453*^9},
 CellLabel->
  "During evaluation of \
In[23]:=",ExpressionUUID->"d876aa34-1bb0-4c8e-a994-e5ac72e29169"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"d_rho_y_dz = \"\>", 
   "\[InvisibleSpace]", "\<\"-((y*z)/((self.epsilon + y*y + \
z*z)*f64::sqrt(self.epsilon + y*y + z*z)))\"\>"}],
  SequenceForm[
  "d_rho_y_dz = ", 
   "-((y*z)/((self.epsilon + y*y + z*z)*f64::sqrt(self.epsilon + y*y + \
z*z)))"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.959962754403612*^9, 3.9599629612489233`*^9, {3.959990684310096*^9, 
   3.959990695057756*^9}, 3.960030022272089*^9},
 CellLabel->
  "During evaluation of \
In[23]:=",ExpressionUUID->"addc13e4-1b9b-4707-bbe3-882448bef04f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "strRules", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"strRules", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<u\>\"", "->", "\"\<self.u\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<sqrt\>\"", "->", "\"\<f64::sqrt\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<epsilon\>\"", "->", "\"\<self.epsilon\>\""}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "r", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "=", 
    RowBox[{"z", "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"y", "^", "2"}], "+", 
       RowBox[{"z", "^", "2"}], "+", "epsilon"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<r = \>\"", ",", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"r", ",", "CForm"}], "]"}], ",", "strRules"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<d_rho_z_dt = \>\"", ",", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{"r", ",", "t"}], "]"}], "]"}], ",", "CForm"}], "]"}], ",", 
     "strRules"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<d_rho_z_dx = \>\"", ",", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{"r", ",", "x"}], "]"}], "]"}], ",", "CForm"}], "]"}], ",", 
     "strRules"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<d_rho_z_dy = \>\"", ",", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{"r", ",", "y"}], "]"}], "]"}], ",", "CForm"}], "]"}], ",", 
     "strRules"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<d_rho_z_dz = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{
        RowBox[{"FullSimplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{"r", ",", "z"}], "]"}], "]"}], ",", "CForm"}], "]"}], ",", 
      "strRules"}], "]"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "r", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "strRules", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.960030035367079*^9, 3.960030039380871*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"c1714ac2-390f-414d-b1e9-4c160cae634d"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"r = \"\>", 
   "\[InvisibleSpace]", "\<\"z/f64::sqrt(self.epsilon + y*y + z*z)\"\>"}],
  SequenceForm["r = ", "z/f64::sqrt(self.epsilon + y*y + z*z)"],
  Editable->False]], "Print",
 CellChangeTimes->{3.960030041620216*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"9cb3310d-1870-4d92-8df5-b9a9f8edaf93"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"d_rho_z_dt = \"\>", "\[InvisibleSpace]", "\<\"0\"\>"}],
  SequenceForm["d_rho_z_dt = ", "0"],
  Editable->False]], "Print",
 CellChangeTimes->{3.96003004162103*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"533d54bc-2105-41d6-a95c-b04f5fe12396"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"d_rho_z_dx = \"\>", "\[InvisibleSpace]", "\<\"0\"\>"}],
  SequenceForm["d_rho_z_dx = ", "0"],
  Editable->False]], "Print",
 CellChangeTimes->{3.9600300416225567`*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"43364703-64a2-4311-9b55-7b1065cee71a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"d_rho_z_dy = \"\>", 
   "\[InvisibleSpace]", "\<\"-((y*z)/((self.epsilon + y*y + \
z*z)*f64::sqrt(self.epsilon + y*y + z*z)))\"\>"}],
  SequenceForm[
  "d_rho_z_dy = ", 
   "-((y*z)/((self.epsilon + y*y + z*z)*f64::sqrt(self.epsilon + y*y + \
z*z)))"],
  Editable->False]], "Print",
 CellChangeTimes->{3.960030041623149*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"25f2dfbc-3ae7-4c55-bef4-8b25c1a0f836"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"d_rho_z_dz = \"\>", 
   "\[InvisibleSpace]", "\<\"(self.epsilon + y*y)/((self.epsilon + y*y + \
z*z)*f64::sqrt(self.epsilon + y*y + z*z))\"\>"}],
  SequenceForm[
  "d_rho_z_dz = ", 
   "(self.epsilon + y*y)/((self.epsilon + y*y + z*z)*f64::sqrt(self.epsilon + \
y*y + z*z))"],
  Editable->False]], "Print",
 CellChangeTimes->{3.960030041623797*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"ed207311-d1ff-4b9a-ae1b-8a51ead8fd2c"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1106.25, 569.25},
WindowMargins->{{1107.75, -1106.25}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
ShowSelection->True,
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
FrontEndVersion->"14.1 for Linux x86 (64-bit) (July 16, 2024)",
StyleDefinitions->FrontEnd`FileName[{"Creative"}, "NaturalColor.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"e9fbdf28-66ce-4359-b2d9-587b79f04be9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 238, 4, 71, "Title",ExpressionUUID->"bed048af-a5ca-4f0b-b6f6-0a823403fb74"],
Cell[CellGroupData[{
Cell[685, 23, 222, 4, 79, "Section",ExpressionUUID->"ad33c86b-e3a4-4257-8179-3dd8917aa76b"],
Cell[CellGroupData[{
Cell[932, 31, 164, 3, 39, "Subsection",ExpressionUUID->"4967b404-806c-4dcc-84a4-e57d86f36387"],
Cell[1099, 36, 6661, 165, 370, "Input",ExpressionUUID->"e0dded18-309d-437b-b537-3139e3f12d23"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7797, 206, 164, 3, 31, "Subsection",ExpressionUUID->"2caf8caf-a570-471e-92ff-0982f27f3efc"],
Cell[7964, 211, 4891, 140, 575, "Input",ExpressionUUID->"7c422bd2-6d77-4765-9e5b-47b734b1f5af"]
}, Closed]],
Cell[CellGroupData[{
Cell[12892, 356, 169, 3, 31, "Subsection",ExpressionUUID->"69a941a0-7e07-47a2-9852-979bf8551d6c"],
Cell[13064, 361, 3704, 75, 286, "Input",ExpressionUUID->"37e0ded1-1af6-4429-a863-997cbd78ad12"]
}, Closed]],
Cell[CellGroupData[{
Cell[16805, 441, 175, 3, 31, "Subsection",ExpressionUUID->"d4763089-f9f6-479f-a9a0-359ecb270085"],
Cell[16983, 446, 247, 4, 34, "Text",ExpressionUUID->"6823b57f-3052-4307-b79c-d32095c33084"],
Cell[17233, 452, 1792, 45, 199, "Input",ExpressionUUID->"e90e3040-e2b9-48f1-b785-ee796988c557"]
}, Closed]],
Cell[CellGroupData[{
Cell[19062, 502, 282, 4, 31, "Subsection",ExpressionUUID->"72fcdbb7-5bc3-4db4-9651-42797cb1dd61"],
Cell[19347, 508, 6439, 153, 569, "Input",ExpressionUUID->"51f8cb81-8be6-41c6-bfd6-e04d5412370f"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[25835, 667, 173, 3, 49, "Section",ExpressionUUID->"29edda33-ca4d-4b75-8ae0-bf142411eef1"],
Cell[26011, 672, 6635, 167, 636, "Input",ExpressionUUID->"f99b543f-05d3-4afe-8079-3e334d178cc7"],
Cell[CellGroupData[{
Cell[32671, 843, 1566, 40, 129, "Input",ExpressionUUID->"d727c731-087d-414c-9106-ce2df8f6f681"],
Cell[34240, 885, 1104, 28, 81, "Output",ExpressionUUID->"52d7b8d3-05d1-4a6d-bd30-4b25ffce0ee7"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[35393, 919, 218, 4, 49, "Section",ExpressionUUID->"4d5fae55-4497-4e9d-b679-70837802b28e"],
Cell[35614, 925, 3134, 88, 323, "Input",ExpressionUUID->"1c4919fb-3aeb-469d-9ab2-fc6040741e23"]
}, Closed]],
Cell[CellGroupData[{
Cell[38785, 1018, 165, 3, 49, "Section",ExpressionUUID->"326122ec-0e9b-4867-b509-b12f97ba23b5"],
Cell[CellGroupData[{
Cell[38975, 1025, 3744, 102, 449, "Input",ExpressionUUID->"aaea7e6b-10ca-460b-a584-e60e9aeeb799"],
Cell[42722, 1129, 2106, 60, 112, "Output",ExpressionUUID->"085a782b-f401-48e8-9f08-27de1c95a9a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44865, 1194, 1033, 21, 252, "Input",ExpressionUUID->"71a826b6-ca30-43de-9d88-4eca31919ae0"],
Cell[45901, 1217, 2990, 83, 147, "Output",ExpressionUUID->"71784638-1666-44a2-8581-8dda5d389735"]
}, Open  ]],
Cell[48906, 1303, 256, 6, 31, "Text",ExpressionUUID->"b367dce0-df8e-417a-aea7-34b641ea2a7a"],
Cell[CellGroupData[{
Cell[49187, 1313, 1581, 46, 130, "Input",ExpressionUUID->"8d3fbc53-bc3a-4c7a-9c20-d24852cc8b71"],
Cell[50771, 1361, 1423, 40, 91, "Output",ExpressionUUID->"6dc6e26c-a91a-42e7-847f-2a7fba3ce3ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52231, 1406, 1505, 43, 92, "Input",ExpressionUUID->"b2ca9664-48c2-4412-91c1-11a8d6c17da9"],
Cell[53739, 1451, 2539, 77, 110, "Output",ExpressionUUID->"1c2c3262-73b8-4975-b630-ca9c25b2806c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56315, 1533, 2692, 73, 365, "Input",ExpressionUUID->"d9db31f1-9440-4c77-83dd-ce906c6f26e3"],
Cell[59010, 1608, 544, 8, 61, "Output",ExpressionUUID->"4fcfe856-c079-442e-9d62-23ec638f088b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[59603, 1622, 135, 3, 49, "Section",ExpressionUUID->"7e2614e4-3ccc-413f-b1ab-5730391be272"],
Cell[CellGroupData[{
Cell[59763, 1629, 225, 4, 39, "Subsection",ExpressionUUID->"d85fc119-c9ed-489e-95a7-d5fd37db53c3"],
Cell[59991, 1635, 3412, 105, 266, "Input",ExpressionUUID->"5ab1d630-79da-404b-9017-f8b13b69a140"]
}, Closed]],
Cell[CellGroupData[{
Cell[63440, 1745, 168, 3, 31, "Subsection",ExpressionUUID->"d572e0a5-9b76-41a8-a2c2-0b60b0081191"],
Cell[CellGroupData[{
Cell[63633, 1752, 8151, 212, 1013, "Input",ExpressionUUID->"1c7d7c67-22cd-4dfb-af84-1f0ae61fb60f"],
Cell[CellGroupData[{
Cell[71809, 1968, 444, 11, 41, "Print",ExpressionUUID->"87e5f5b2-4753-4491-b946-b21139741063"],
Cell[72256, 1981, 444, 11, 41, "Print",ExpressionUUID->"c687123d-69ee-4825-a81a-0b742c039a92"],
Cell[72703, 1994, 444, 11, 41, "Print",ExpressionUUID->"db2b0954-5e2f-4a49-ad35-3fcd9f97e216"],
Cell[73150, 2007, 871, 19, 79, "Print",ExpressionUUID->"6b623966-77b6-459a-b92f-ad1013dba3ba"],
Cell[74024, 2028, 891, 19, 79, "Print",ExpressionUUID->"6a634b90-19c4-40db-965a-991900af6c18"],
Cell[74918, 2049, 901, 19, 60, "Print",ExpressionUUID->"0870b48a-7f13-4058-a15d-9b958057008b"],
Cell[75822, 2070, 787, 17, 41, "Print",ExpressionUUID->"fc487a09-2abd-4e33-b1a2-3ca59168aca6"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[76670, 2094, 182, 3, 31, "Subsection",ExpressionUUID->"cd6e1167-e4ac-4957-897a-b7eb9f8d4e09"],
Cell[CellGroupData[{
Cell[76877, 2101, 3541, 91, 428, "Input",ExpressionUUID->"98330ef6-fd15-4c22-b993-752312922d08"],
Cell[CellGroupData[{
Cell[80443, 2196, 683, 15, 23, "Print",ExpressionUUID->"7635ec5c-5f90-4243-8155-efba75190da7"],
Cell[81129, 2213, 781, 17, 41, "Print",ExpressionUUID->"9324e092-8cd7-4f67-9020-50e2068e1156"],
Cell[81913, 2232, 759, 17, 41, "Print",ExpressionUUID->"10a0666c-ae06-415c-b499-2497cc0cb6d5"],
Cell[82675, 2251, 699, 16, 23, "Print",ExpressionUUID->"cba8a436-2ac1-4e5c-be38-863d04109196"],
Cell[83377, 2269, 699, 16, 23, "Print",ExpressionUUID->"9c05e06d-8dcb-4881-aed4-340094825600"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[84125, 2291, 3329, 87, 428, "Input",ExpressionUUID->"48a69f2a-9f4b-4923-9b37-591699f31280"],
Cell[CellGroupData[{
Cell[87479, 2382, 478, 11, 23, "Print",ExpressionUUID->"e0839937-1825-4da5-adec-cc1e7e38712d"],
Cell[87960, 2395, 418, 10, 23, "Print",ExpressionUUID->"06528c16-05c4-4356-ab63-652d186a682a"],
Cell[88381, 2407, 418, 10, 23, "Print",ExpressionUUID->"3feeb4f6-87f4-4c57-8206-9dcf6c2a43ef"],
Cell[88802, 2419, 601, 15, 23, "Print",ExpressionUUID->"d876aa34-1bb0-4c8e-a994-e5ac72e29169"],
Cell[89406, 2436, 577, 15, 23, "Print",ExpressionUUID->"addc13e4-1b9b-4707-bbe3-882448bef04f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[90032, 2457, 2957, 82, 428, "Input",ExpressionUUID->"c1714ac2-390f-414d-b1e9-4c160cae634d"],
Cell[CellGroupData[{
Cell[93014, 2543, 377, 9, 23, "Print",ExpressionUUID->"9cb3310d-1870-4d92-8df5-b9a9f8edaf93"],
Cell[93394, 2554, 318, 8, 23, "Print",ExpressionUUID->"533d54bc-2105-41d6-a95c-b04f5fe12396"],
Cell[93715, 2564, 321, 8, 23, "Print",ExpressionUUID->"43364703-64a2-4311-9b55-7b1065cee71a"],
Cell[94039, 2574, 478, 13, 23, "Print",ExpressionUUID->"25f2dfbc-3ae7-4c55-bef4-8b25c1a0f836"],
Cell[94520, 2589, 502, 13, 23, "Print",ExpressionUUID->"ed207311-d1ff-4b9a-ae1b-8a51ead8fd2c"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

